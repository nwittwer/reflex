{"version":3,"sources":["webpack://electronPlaywrightBrowserInstaller/webpack/universalModuleDefinition","webpack://electronPlaywrightBrowserInstaller/external \"playwright-core\"","webpack://electronPlaywrightBrowserInstaller/./src/lib/index.js","webpack://electronPlaywrightBrowserInstaller/./src/lib/emitter.js","webpack://electronPlaywrightBrowserInstaller/./src/lib/install/browserFetcher.js","webpack://electronPlaywrightBrowserInstaller/./src/lib/install/installer.js","webpack://electronPlaywrightBrowserInstaller/./src/lib/utils/browserPaths.js","webpack://electronPlaywrightBrowserInstaller/./src/lib/utils/ubuntuVersion.js","webpack://electronPlaywrightBrowserInstaller/./src/lib/utils/utils.js","webpack://electronPlaywrightBrowserInstaller/external \"child_process\"","webpack://electronPlaywrightBrowserInstaller/external \"console-browserify\"","webpack://electronPlaywrightBrowserInstaller/external \"crypto\"","webpack://electronPlaywrightBrowserInstaller/external \"events\"","webpack://electronPlaywrightBrowserInstaller/external \"extract-zip\"","webpack://electronPlaywrightBrowserInstaller/external \"fs\"","webpack://electronPlaywrightBrowserInstaller/external \"http\"","webpack://electronPlaywrightBrowserInstaller/external \"https\"","webpack://electronPlaywrightBrowserInstaller/external \"https-proxy-agent\"","webpack://electronPlaywrightBrowserInstaller/external \"os\"","webpack://electronPlaywrightBrowserInstaller/external \"path\"","webpack://electronPlaywrightBrowserInstaller/external \"process/browser\"","webpack://electronPlaywrightBrowserInstaller/external \"progress\"","webpack://electronPlaywrightBrowserInstaller/external \"proper-lockfile\"","webpack://electronPlaywrightBrowserInstaller/external \"proxy-from-env\"","webpack://electronPlaywrightBrowserInstaller/external \"rimraf\"","webpack://electronPlaywrightBrowserInstaller/external \"url\"","webpack://electronPlaywrightBrowserInstaller/external \"util\"","webpack://electronPlaywrightBrowserInstaller/webpack/bootstrap","webpack://electronPlaywrightBrowserInstaller/webpack/startup","webpack://electronPlaywrightBrowserInstaller/webpack/runtime/compat get default export","webpack://electronPlaywrightBrowserInstaller/webpack/runtime/define property getters","webpack://electronPlaywrightBrowserInstaller/webpack/runtime/hasOwnProperty shorthand","webpack://electronPlaywrightBrowserInstaller/webpack/runtime/make namespace object"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","this","require","packageName","logTypes","console","log","generator","type","old","Array","prototype","unshift","call","arguments","toUpperCase","apply","map","installBrowsersWithProgressBar","Installer","options","browsers","checkIfInstalled","install","dirPath","warn","length","error","browser","playwright","executablePath","downloadEmitter","current","total","name","msg","async","__dirname","catch","err","stack","process","exit","results","ls","path","tempArr","dir","fs","dirent","push","every","v","find","x","includes","checkInstallDir","getPackagedPlaywrightExecPath","initialPath","updatedPath","replaceAll","str","mapObj","re","RegExp","Object","keys","join","replace","matched","toLowerCase","EventEmitter","on","defineProperty","value","logPolitely","downloadBrowserWithProgressBar","extract","os","proxy_from_env_1","URL","util","utils_1","browserPaths","ProxyAgent","unlinkAsync","promisify","unlink","bind","chmodAsync","chmod","existsAsync","Promise","resolve","stat","CHROMIUM_MOVE_TO_AZURE_CDN_REVISION","revisionURL","platform","hostPlatform","revision","parseInt","serverHost","getDownloadHost","browserName","defaultDownloadHost","getFromENV","chromium","firefox","webkit","urlTemplate","getDownloadUrl","Map","get","undefined","assert","format","browsersPath","browserPath","browserDirectory","progressBarName","url","zipPath","tmpdir","downloadFile","destinationPath","progressCallback","fulfill","reject","downloadedBytes","totalBytes","promise","y","httpRequest","response","statusCode","Error","resume","file","createWriteStream","pipe","headers","onData","chunk","progress","delta","toMegabytes","finalMsg","e","exitCode","bytes","mb","Math","round","method","parse","proxyURL","getProxyForUrl","startsWith","proxy","href","host","hostname","port","parsedProxyURL","secureProxy","protocol","agent","rejectUnauthorized","requestCallback","res","location","request","end","toBeLogged","logLevel","env","npm_config_loglevel","indexOf","crypto","removeFolder","lockfile","browserFetcher","fsMkdirAsync","mkdir","fsReaddirAsync","readdir","fsReadFileAsync","readFile","fsUnlinkAsync","fsWriteFileAsync","writeFile","removeFolderAsync","packagePath","getAsBooleanFromENV","recursive","lockfilePath","releaseLock","lock","retries","factor","onCompromised","message","linksDir","sha1","data","sum","createHash","update","digest","validateCache","usedBrowserPaths","Set","fileName","linkPath","linkTarget","toString","browsersToDownload","readBrowsersToDownload","usedBrowserPath","browserRevision","filePath","markerFilePath","then","add","downloadedBrowsers","filter","isBrowserDirectory","directories","delete","directory","myBrowsersToDownload","JSON","download","windowsExeAndDllDirectories","linuxLddDirectories","child_process_1","ubuntuVersion_1","macVersion","execSync","stdio","trim","split","slice","arm64","ubuntuVersion","getUbuntuVersionSync","arch","tokens","defaultBrowsersPath","cacheDirectory","XDG_CACHE_HOME","homedir","LOCALAPPDATA","baseName","basename","getUbuntuVersion","readFileAsync","getUbuntuVersionInternal","osReleaseText","fields","line","shift","endsWith","substring","set","readFileSync","createGuid","calculateSha1","monotonicTime","headersArrayToObject","headersObjectToArray","mkdirIfNeeded","isUnderTest","setUnderTest","isDebugMode","isError","isObject","isRegExp","isString","debugAssert","makeWaitForNextTask","mkdirAsync","versions","node","setImmediate","spinning","callbacks","loop","callback","obj","String","__proto__","isInDebugMode","_isUnderTest","dirname","result","is","lowerCase","seconds","nanoseconds","hrtime","buffer","hash","randomBytes","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","enumerable","prop","hasOwnProperty","r","Symbol","toStringTag"],"mappings":"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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"electronPlaywrightBrowserInstaller\"] = factory();\n\telse\n\t\troot[\"electronPlaywrightBrowserInstaller\"] = factory();\n})(this, function() {\nreturn ","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"playwright-core\");;","import { promises as fs } from 'fs'\nimport playwright from 'playwright-core'\n\n// We'll prepend console.log messages for this library\n// via https://stackoverflow.com/a/16259739/1114901\n/**\n * Attach to the EventEmitter\n * This allows us to stream the download progress\n */\nimport { downloadEmitter } from './emitter'\n\n// import \"core-js/stable\";\n// import \"regenerator-runtime/runtime\";\n\nconst packageName = 'electron-playwright-browser-installer'\n\nconst logTypes = ['log', 'error', 'info']\nif (console.log) {\n  const generator = (type) => {\n    const old = console[type]\n    console[type] = function () {\n      Array.prototype.unshift.call(arguments, `${packageName.toUpperCase()}:`)\n      old.apply(this, arguments)\n    }\n  }\n  // Apply to each type of console\n  logTypes.map(generator)\n}\n\n/**\n * This file exposes a class interface for\n * displaying the browser installation progress\n */\nconst { installBrowsersWithProgressBar } = require('./install/installer')\n\nexport class Installer {\n  constructor(options = {}) {\n    options = options || {}\n    this.browsers = options.browsers || ['chromium', 'firefox', 'webkit']\n  }\n\n  async run() {\n    const isInstalled = await this.checkIfInstalled()\n\n    if (isInstalled) {\n      console.log('Browsers are installed.')\n    } else {\n      // Not installed yet\n      console.log('Browsers are NOT installed!')\n      await this.install()\n    }\n  }\n\n  checkIfInstalled(dirPath) {\n    // Check for installed browsers in a directory\n    console.log('Checking if browsers are installed...')\n\n    return false // TODO Actually check a directory...\n  }\n\n  async install(\n    options = {\n      browsers: this.browsers,\n    }\n  ) {\n    // Ensure the the user has configured the expected environment variable\n    if (process.env.PLAYWRIGHT_BROWSERS_PATH !== '0') {\n      console.warn('Env var PLAYWRIGHT_BROWSERS_PATH is missing or incorrect')\n      // return false\n    }\n\n    if (options.browsers.length) {\n      for (const browser of options.browsers) {\n        console.log(`Path: ${playwright[browser].executablePath()}`)\n      }\n    } else {\n      console.error('No browsers were passed in to install')\n      return false\n    }\n\n    // Start listening for download events\n    // Listen to progress events\n    downloadEmitter.on('progress', ({ current, total, name }) => {\n      const msg = `Downloading ${name} - ${current}/${total}`\n      console.log(msg)\n    })\n\n    downloadEmitter.on('done', async () => {\n      // Function here\n      // console.log(`It's done downloading!`);\n    })\n\n    // Example via Playwright's Github Installer\n    // https://github.com/microsoft/playwright/blob/master/install-from-github.js#L29\n    await installBrowsersWithProgressBar(__dirname).catch((err) => {\n      console.error(`Failed to install browsers, caused by\\n${err.stack}`)\n      process.exit(1)\n    })\n\n    // Verify that there is a directory for each of the browsers\n    const checkInstallDir = async () => {\n      const results = await ls(`${__dirname}/.local-browsers`)\n      const { browsers } = options\n      return browsers.every((v) => results.find((x) => x.includes(v)))\n    }\n\n    if ((await checkInstallDir()) === true) {\n      console.log('Browsers are installed.')\n      return true\n    } else {\n      console.error('Browsers are NOT installed!')\n      return false\n    }\n  }\n}\n\n// Find all files & folders at a path\n// https://stackoverflow.com/a/59042581/1114901\nasync function ls(path) {\n  try {\n    const tempArr = []\n    const dir = await fs.opendir(path) // Opens a stream https://nodejs.org/api/fs.html#fs_class_fs_dir\n\n    for await (const dirent of dir) {\n      tempArr.push(dirent.name)\n    }\n\n    return tempArr // return all the files & directories at the output dir\n  } catch (err) {\n    console.error(err)\n    return false\n  }\n}\n\n// Amend the Playwright executable path when packaged\n// via https://github.com/puppeteer/puppeteer/issues/2134#issuecomment-408221446\nexport function getPackagedPlaywrightExecPath(browser) {\n  if (!browser) console.error('No browser name given.')\n\n  function replaceAll(str, mapObj) {\n    const re = new RegExp(Object.keys(mapObj).join('|'), 'gi')\n\n    return str.replace(re, function (matched) {\n      return mapObj[matched.toLowerCase()]\n    })\n  }\n\n  const mapObj = {\n    playwright: 'electron-playwright-browser-installer',\n    'app.asar': 'app.asar.unpacked',\n  }\n\n  // Generate the correct paths\n  // console.log(\"Playwright module\", !!playwright);\n  const initialPath = playwright[browser].executablePath()\n  const updatedPath = replaceAll(initialPath, mapObj)\n  console.log(\n    'Is the path the same as initially?',\n    initialPath === updatedPath,\n    `Changed to: ${updatedPath}`\n  )\n\n  return updatedPath\n}\n\n// Export the default (Installer class)\n// export default {\n//   Installer,\n//   getPackagedPlaywrightExecPath,\n// };\n","/**\n * Event emitter\n * This allows us to expose the download progress\n * See: lib/install/browserFetcher.js\n */\nconst { EventEmitter } = require(\"events\");\nexport const downloadEmitter = new EventEmitter();\n\n/**\n * Here's an example\n */\n\n// Listen to progress events\ndownloadEmitter.on(\"progress\", async ({ current, total, name }) => {\n  const msg = `Downloading ${name} - ${current}/${total}`;\n  console.log(msg);\n});\n\ndownloadEmitter.on(\"done\", async () => {\n  // Function here\n});\n\nexport default downloadEmitter;\n","\"use strict\";\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.logPolitely = exports.downloadBrowserWithProgressBar = void 0;\n\n/**\n * Attach to the EventEmitter\n * This allows us to stream the download progress\n */\nimport { downloadEmitter } from \"../emitter\";\n\nconst extract = require(\"extract-zip\");\nconst fs = require(\"fs\");\nconst os = require(\"os\");\nconst path = require(\"path\");\nconst ProgressBar = require(\"progress\");\nconst proxy_from_env_1 = require(\"proxy-from-env\");\nconst URL = require(\"url\");\nconst util = require(\"util\");\nconst utils_1 = require(\"../utils/utils\");\nconst browserPaths = require(\"../utils/browserPaths\");\n// `https-proxy-agent` v5 is written in Typescript and exposes generated types.\n// However, as of June 2020, its types are generated with tsconfig that enables\n// `esModuleInterop` option.\n//\n// As a result, we can't depend on the package unless we enable the option\n// for our codebase. Instead of doing this, we abuse \"require\" to import module\n// without types.\nconst ProxyAgent = require(\"https-proxy-agent\");\nconst unlinkAsync = util.promisify(fs.unlink.bind(fs));\nconst chmodAsync = util.promisify(fs.chmod.bind(fs));\nconst existsAsync = (path) =>\n  new Promise((resolve) => fs.stat(path, (err) => resolve(!err)));\nconst CHROMIUM_MOVE_TO_AZURE_CDN_REVISION = 792639;\nfunction getDownloadHost(browserName, revision) {\n  // Only old chromium revisions are downloaded from gbucket.\n  const defaultDownloadHost =\n    browserName === \"chromium\" && revision < CHROMIUM_MOVE_TO_AZURE_CDN_REVISION\n      ? \"https://storage.googleapis.com\"\n      : \"https://playwright.azureedge.net\";\n  const envDownloadHost = {\n    chromium: \"PLAYWRIGHT_CHROMIUM_DOWNLOAD_HOST\",\n    firefox: \"PLAYWRIGHT_FIREFOX_DOWNLOAD_HOST\",\n    webkit: \"PLAYWRIGHT_WEBKIT_DOWNLOAD_HOST\",\n  };\n  return (\n    utils_1.getFromENV(envDownloadHost[browserName]) ||\n    utils_1.getFromENV(\"PLAYWRIGHT_DOWNLOAD_HOST\") ||\n    defaultDownloadHost\n  );\n}\nfunction getDownloadUrl(browserName, revision, platform) {\n  if (browserName === \"chromium\") {\n    return revision < CHROMIUM_MOVE_TO_AZURE_CDN_REVISION\n      ? new Map([\n          [\n            \"ubuntu18.04\",\n            \"%s/chromium-browser-snapshots/Linux_x64/%d/chrome-linux.zip\",\n          ],\n          [\n            \"ubuntu20.04\",\n            \"%s/chromium-browser-snapshots/Linux_x64/%d/chrome-linux.zip\",\n          ],\n          [\"mac10.13\", \"%s/chromium-browser-snapshots/Mac/%d/chrome-mac.zip\"],\n          [\"mac10.14\", \"%s/chromium-browser-snapshots/Mac/%d/chrome-mac.zip\"],\n          [\"mac10.15\", \"%s/chromium-browser-snapshots/Mac/%d/chrome-mac.zip\"],\n          [\"mac11.0\", \"%s/chromium-browser-snapshots/Mac/%d/chrome-mac.zip\"],\n          [\"mac11.1\", \"%s/chromium-browser-snapshots/Mac/%d/chrome-mac.zip\"],\n          [\"win32\", \"%s/chromium-browser-snapshots/Win/%d/chrome-win.zip\"],\n          [\"win64\", \"%s/chromium-browser-snapshots/Win_x64/%d/chrome-win.zip\"],\n        ]).get(platform)\n      : new Map([\n          [\"ubuntu18.04\", \"%s/builds/chromium/%s/chromium-linux.zip\"],\n          [\"ubuntu20.04\", \"%s/builds/chromium/%s/chromium-linux.zip\"],\n          [\"mac10.13\", \"%s/builds/chromium/%s/chromium-mac.zip\"],\n          [\"mac10.14\", \"%s/builds/chromium/%s/chromium-mac.zip\"],\n          [\"mac10.15\", \"%s/builds/chromium/%s/chromium-mac.zip\"],\n          [\"mac11.0\", \"%s/builds/chromium/%s/chromium-mac.zip\"],\n          [\"mac11.0-arm64\", \"%s/builds/chromium/%s/chromium-mac-arm64.zip\"],\n          [\"mac11.1\", \"%s/builds/chromium/%s/chromium-mac.zip\"],\n          [\"mac11.1-arm64\", \"%s/builds/chromium/%s/chromium-mac-arm64.zip\"],\n          [\"win32\", \"%s/builds/chromium/%s/chromium-win32.zip\"],\n          [\"win64\", \"%s/builds/chromium/%s/chromium-win64.zip\"],\n        ]).get(platform);\n  }\n  if (browserName === \"firefox\") {\n    const FIREFOX_NORMALIZE_CDN_NAMES_REVISION = 1140;\n    return revision < FIREFOX_NORMALIZE_CDN_NAMES_REVISION\n      ? new Map([\n          [\"ubuntu18.04\", \"%s/builds/firefox/%s/firefox-linux.zip\"],\n          [\"ubuntu20.04\", \"%s/builds/firefox/%s/firefox-linux.zip\"],\n          [\"mac10.13\", \"%s/builds/firefox/%s/firefox-mac.zip\"],\n          [\"mac10.14\", \"%s/builds/firefox/%s/firefox-mac.zip\"],\n          [\"mac10.15\", \"%s/builds/firefox/%s/firefox-mac.zip\"],\n          [\"mac11.0\", \"%s/builds/firefox/%s/firefox-mac.zip\"],\n          [\"mac11.1\", \"%s/builds/firefox/%s/firefox-mac.zip\"],\n          [\"win32\", \"%s/builds/firefox/%s/firefox-win32.zip\"],\n          [\"win64\", \"%s/builds/firefox/%s/firefox-win64.zip\"],\n        ]).get(platform)\n      : new Map([\n          [\"ubuntu18.04\", \"%s/builds/firefox/%s/firefox-ubuntu-18.04.zip\"],\n          [\"ubuntu20.04\", \"%s/builds/firefox/%s/firefox-ubuntu-18.04.zip\"],\n          [\"mac10.13\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"mac10.14\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"mac10.15\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"mac11.0\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"mac11.0-arm64\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"mac11.1\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"mac11.1-arm64\", \"%s/builds/firefox/%s/firefox-mac-10.14.zip\"],\n          [\"win32\", \"%s/builds/firefox/%s/firefox-win32.zip\"],\n          [\"win64\", \"%s/builds/firefox/%s/firefox-win64.zip\"],\n        ]).get(platform);\n  }\n  if (browserName === \"webkit\") {\n    const WEBKIT_NORMALIZE_CDN_NAMES_REVISION = 1317;\n    return revision < WEBKIT_NORMALIZE_CDN_NAMES_REVISION\n      ? new Map([\n          [\"ubuntu18.04\", \"%s/builds/webkit/%s/minibrowser-gtk-wpe.zip\"],\n          [\"ubuntu20.04\", \"%s/builds/webkit/%s/minibrowser-gtk-wpe.zip\"],\n          [\"mac10.13\", undefined],\n          [\"mac10.14\", \"%s/builds/webkit/%s/minibrowser-mac-10.14.zip\"],\n          [\"mac10.15\", \"%s/builds/webkit/%s/minibrowser-mac-10.15.zip\"],\n          [\"mac11.0\", \"%s/builds/webkit/%s/minibrowser-mac-10.15.zip\"],\n          [\"mac11.1\", \"%s/builds/webkit/%s/minibrowser-mac-10.15.zip\"],\n          [\"win32\", \"%s/builds/webkit/%s/minibrowser-win64.zip\"],\n          [\"win64\", \"%s/builds/webkit/%s/minibrowser-win64.zip\"],\n        ]).get(platform)\n      : new Map([\n          [\"ubuntu18.04\", \"%s/builds/webkit/%s/webkit-ubuntu-18.04.zip\"],\n          [\"ubuntu20.04\", \"%s/builds/webkit/%s/webkit-ubuntu-20.04.zip\"],\n          [\"mac10.13\", undefined],\n          [\"mac10.14\", \"%s/builds/webkit/%s/webkit-mac-10.14.zip\"],\n          [\"mac10.15\", \"%s/builds/webkit/%s/webkit-mac-10.15.zip\"],\n          [\"mac11.0\", \"%s/builds/webkit/%s/webkit-mac-10.15.zip\"],\n          [\"mac11.0-arm64\", \"%s/builds/webkit/%s/webkit-mac-11.0-arm64.zip\"],\n          [\"mac11.1\", \"%s/builds/webkit/%s/webkit-mac-10.15.zip\"],\n          [\"mac11.1-arm64\", \"%s/builds/webkit/%s/webkit-mac-11.0-arm64.zip\"],\n          [\"win32\", \"%s/builds/webkit/%s/webkit-win64.zip\"],\n          [\"win64\", \"%s/builds/webkit/%s/webkit-win64.zip\"],\n        ]).get(platform);\n  }\n}\nfunction revisionURL(browser, platform = browserPaths.hostPlatform) {\n  const revision = parseInt(browser.revision, 10);\n  const serverHost = getDownloadHost(browser.name, revision);\n  const urlTemplate = getDownloadUrl(browser.name, revision, platform);\n  utils_1.assert(\n    urlTemplate,\n    `ERROR: Playwright does not support ${browser.name} on ${platform}`\n  );\n  return util.format(urlTemplate, serverHost, browser.revision);\n}\n\nexport async function downloadBrowserWithProgressBar(browsersPath, browser) {\n  const browserPath = browserPaths.browserDirectory(browsersPath, browser);\n  const progressBarName = `${browser.name} v${browser.revision}`;\n  if (await existsAsync(browserPath)) {\n    // Already downloaded.\n    return false;\n  }\n  let progressBar;\n  let lastDownloadedBytes = 0;\n  function progress(downloadedBytes, totalBytes) {\n    const delta = downloadedBytes - lastDownloadedBytes;\n    // if (!progressBar) {\n    //   progressBar = new ProgressBar(\n    //     `Downloading ${progressBarName} - ${toMegabytes(\n    //       totalBytes\n    //     )} [:bar] :percent :etas `,\n    //     {\n    //       complete: \"=\",\n    //       incomplete: \" \",\n    //       width: 20,\n    //       total: totalBytes,\n    //     }\n    //   );\n    // }\n    // lastDownloadedBytes = downloadedBytes;\n    // progressBar.tick(delta);\n\n    // Emit the progress\n    // This function is called whenever there's new bytes downloaded\n    downloadEmitter.emit(\"progress\", {\n      name: progressBarName,\n      delta: delta,\n      current: toMegabytes(downloadedBytes),\n      total: toMegabytes(totalBytes),\n    });\n\n    // Done!\n    if (downloadedBytes === totalBytes) {\n      const finalMsg = `${progressBarName} installed.`;\n      downloadEmitter.emit(\"done\", finalMsg);\n      console.log(finalMsg);\n    }\n  }\n  const url = revisionURL(browser);\n  const zipPath = path.join(\n    os.tmpdir(),\n    `playwright-download-${browser.name}-${browserPaths.hostPlatform}-${browser.revision}.zip`\n  );\n  try {\n    await downloadFile(url, zipPath, progress);\n    await extract(zipPath, { dir: browserPath });\n    await chmodAsync(browserPaths.executablePath(browserPath, browser), 0o755);\n  } catch (e) {\n    process.exitCode = 1;\n    throw e;\n  } finally {\n    if (await existsAsync(zipPath)) await unlinkAsync(zipPath);\n  }\n  logPolitely(`${progressBarName} downloaded to ${browserPath}`);\n  return true;\n}\n// exports.downloadBrowserWithProgressBar = downloadBrowserWithProgressBar;\n\nfunction toMegabytes(bytes) {\n  const mb = bytes / 1024 / 1024;\n  return `${Math.round(mb * 10) / 10} Mb`;\n}\nfunction downloadFile(url, destinationPath, progressCallback) {\n  let fulfill = () => {};\n  let reject = () => {};\n  let downloadedBytes = 0;\n  let totalBytes = 0;\n  const promise = new Promise((x, y) => {\n    fulfill = x;\n    reject = y;\n  });\n  const request = httpRequest(url, \"GET\", (response) => {\n    if (response.statusCode !== 200) {\n      const error = new Error(\n        `Download failed: server returned code ${response.statusCode}. URL: ${url}`\n      );\n      // consume response data to free up memory\n      response.resume();\n      reject(error);\n      return;\n    }\n    const file = fs.createWriteStream(destinationPath);\n    file.on(\"finish\", () => fulfill());\n    file.on(\"error\", (error) => reject(error));\n    response.pipe(file);\n    totalBytes = parseInt(response.headers[\"content-length\"], 10);\n    if (progressCallback) response.on(\"data\", onData);\n  });\n  request.on(\"error\", (error) => reject(error));\n  return promise;\n  function onData(chunk) {\n    downloadedBytes += chunk.length;\n    progressCallback(downloadedBytes, totalBytes);\n  }\n}\nfunction httpRequest(url, method, response) {\n  let options = URL.parse(url);\n  options.method = method;\n  const proxyURL = proxy_from_env_1.getProxyForUrl(url);\n  if (proxyURL) {\n    if (url.startsWith(\"http:\")) {\n      const proxy = URL.parse(proxyURL);\n      options = {\n        path: options.href,\n        host: proxy.hostname,\n        port: proxy.port,\n      };\n    } else {\n      const parsedProxyURL = URL.parse(proxyURL);\n      parsedProxyURL.secureProxy = parsedProxyURL.protocol === \"https:\";\n      options.agent = new ProxyAgent(parsedProxyURL);\n      options.rejectUnauthorized = false;\n    }\n  }\n  const requestCallback = (res) => {\n    if (res.statusCode >= 300 && res.statusCode < 400 && res.headers.location)\n      httpRequest(res.headers.location, method, response);\n    else response(res);\n  };\n  const request =\n    options.protocol === \"https:\"\n      ? require(\"https\").request(options, requestCallback)\n      : require(\"http\").request(options, requestCallback);\n  request.end();\n  return request;\n}\n\nexport function logPolitely(toBeLogged) {\n  const logLevel = process.env.npm_config_loglevel;\n  const logLevelDisplay =\n    [\"silent\", \"error\", \"warn\"].indexOf(logLevel || \"\") > -1;\n  if (!logLevelDisplay) console.log(toBeLogged); // eslint-disable-line no-console\n}\n// exports.logPolitely = logPolitely;\n//# sourceMappingURL=browserFetcher.js.map\n","'use strict'\n/**\n * Copyright Microsoft Corporation. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, '__esModule', { value: true })\n// exports.installBrowsersWithProgressBar = void 0;\nconst crypto = require('crypto')\nconst fs = require('fs')\nconst path = require('path')\nconst util = require('util')\nconst removeFolder = require('rimraf')\nconst lockfile = require('proper-lockfile')\nconst browserPaths = require('../utils/browserPaths')\nconst utils_1 = require('../utils/utils')\nconst browserFetcher = require('./browserFetcher')\nconst fsMkdirAsync = util.promisify(fs.mkdir.bind(fs))\nconst fsReaddirAsync = util.promisify(fs.readdir.bind(fs))\nconst fsReadFileAsync = util.promisify(fs.readFile.bind(fs))\nconst fsExistsAsync = (filePath) =>\n  fsReadFileAsync(filePath)\n    .then(() => true)\n    .catch((e) => false)\nconst fsUnlinkAsync = util.promisify(fs.unlink.bind(fs))\nconst fsWriteFileAsync = util.promisify(fs.writeFile.bind(fs))\nconst removeFolderAsync = util.promisify(removeFolder)\n\nexport async function installBrowsersWithProgressBar(packagePath) {\n  if (process.env.PLAYWRIGHT_BROWSERS_PATH !== '0') {\n    console.error('Missing or incorrect PLAYWRIGHT_BROWSERS_PATH env')\n  }\n\n  // PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD should have a value of 0 or 1\n  if (utils_1.getAsBooleanFromENV('PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD')) {\n    browserFetcher.logPolitely(\n      'Skipping browsers download because `PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD` env variable is set'\n    )\n    return false\n  }\n  const browsersPath = browserPaths.browsersPath(packagePath)\n  await fsMkdirAsync(browsersPath, { recursive: true })\n  const lockfilePath = path.join(browsersPath, '__dirlock')\n  const releaseLock = await lockfile.lock(browsersPath, {\n    retries: {\n      retries: 10,\n      // Retry 20 times during 10 minutes with\n      // exponential back-off.\n      // See documentation at: https://www.npmjs.com/package/retry#retrytimeoutsoptions\n      factor: 1.27579,\n    },\n    onCompromised: (err) => {\n      throw new Error(`${err.message} Path: ${lockfilePath}`)\n    },\n    lockfilePath,\n  })\n  const linksDir = path.join(browsersPath, '.links')\n  await fsMkdirAsync(linksDir, { recursive: true })\n  await fsWriteFileAsync(path.join(linksDir, sha1(packagePath)), packagePath)\n  await validateCache(packagePath, browsersPath, linksDir)\n  await releaseLock()\n}\n// exports.installBrowsersWithProgressBar = installBrowsersWithProgressBar;\n\nexport async function validateCache(packagePath, browsersPath, linksDir) {\n  // 1. Collect used downloads and package descriptors.\n  const usedBrowserPaths = new Set()\n  for (const fileName of await fsReaddirAsync(linksDir)) {\n    const linkPath = path.join(linksDir, fileName)\n    let linkTarget = ''\n    try {\n      linkTarget = (await fsReadFileAsync(linkPath)).toString()\n      const browsersToDownload = await readBrowsersToDownload(linkTarget)\n      for (const browser of browsersToDownload) {\n        const usedBrowserPath = browserPaths.browserDirectory(\n          browsersPath,\n          browser\n        )\n        const browserRevision = parseInt(browser.revision, 10)\n        // Old browser installations don't have marker file.\n        const shouldHaveMarkerFile =\n          (browser.name === 'chromium' && browserRevision >= 786218) ||\n          (browser.name === 'firefox' && browserRevision >= 1128) ||\n          (browser.name === 'webkit' && browserRevision >= 1307)\n        if (\n          !shouldHaveMarkerFile ||\n          (await fsExistsAsync(\n            browserPaths.markerFilePath(browsersPath, browser)\n          ))\n        )\n          usedBrowserPaths.add(usedBrowserPath)\n      }\n    } catch (e) {\n      if (linkTarget)\n        browserFetcher.logPolitely(\n          'Failed to process descriptor at ' + linkTarget\n        )\n      await fsUnlinkAsync(linkPath).catch((e) => {})\n    }\n  }\n  // 2. Delete all unused browsers.\n  let downloadedBrowsers = (await fsReaddirAsync(browsersPath)).map((file) =>\n    path.join(browsersPath, file)\n  )\n  downloadedBrowsers = downloadedBrowsers.filter((file) =>\n    browserPaths.isBrowserDirectory(file)\n  )\n  const directories = new Set(downloadedBrowsers)\n  for (const browserPath of usedBrowserPaths) directories.delete(browserPath)\n  for (const directory of directories) {\n    browserFetcher.logPolitely('Removing unused browser at ' + directory)\n    await removeFolderAsync(directory).catch((e) => {})\n  }\n  // 3. Install missing browsers for this package.\n  const myBrowsersToDownload = await readBrowsersToDownload(packagePath)\n  for (const browser of myBrowsersToDownload) {\n    await browserFetcher.downloadBrowserWithProgressBar(browsersPath, browser)\n    await fsWriteFileAsync(\n      browserPaths.markerFilePath(browsersPath, browser),\n      ''\n    )\n  }\n}\n\nexport async function readBrowsersToDownload(packagePath) {\n  const browsers = JSON.parse(\n    (await fsReadFileAsync(path.join(packagePath, 'browsers.json'))).toString()\n  ).browsers\n  // Older versions do not have \"download\" field. We assume they need all browsers\n  // from the list. So we want to skip all browsers that are explicitly marked as \"download: false\".\n  return browsers.filter((browser) => browser.download !== false)\n}\nfunction sha1(data) {\n  const sum = crypto.createHash('sha1')\n  sum.update(data)\n  return sum.digest('hex')\n}\n// # sourceMappingURL=installer.js.map\n","\"use strict\";\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isBrowserDirectory = exports.markerFilePath = exports.browserDirectory = exports.browsersPath = exports.executablePath = exports.windowsExeAndDllDirectories = exports.linuxLddDirectories = exports.hostPlatform = void 0;\nconst child_process_1 = require(\"child_process\");\nconst os = require(\"os\");\nconst path = require(\"path\");\nconst ubuntuVersion_1 = require(\"./ubuntuVersion\");\nconst utils_1 = require(\"./utils\");\nexports.hostPlatform = (() => {\n  const platform = os.platform();\n  if (platform === \"darwin\") {\n    const macVersion = child_process_1\n      .execSync(\"sw_vers -productVersion\", {\n        stdio: [\"ignore\", \"pipe\", \"ignore\"],\n      })\n      .toString(\"utf8\")\n      .trim()\n      .split(\".\")\n      .slice(0, 2)\n      .join(\".\");\n    let arm64 = false;\n    if (!macVersion.startsWith(\"10.\")) {\n      arm64 =\n        child_process_1\n          .execSync(\"sysctl -in hw.optional.arm64\", {\n            stdio: [\"ignore\", \"pipe\", \"ignore\"],\n          })\n          .toString()\n          .trim() === \"1\";\n    }\n    const archSuffix = arm64 ? \"-arm64\" : \"\";\n    return `mac${macVersion}${archSuffix}`;\n  }\n  if (platform === \"linux\") {\n    const ubuntuVersion = ubuntuVersion_1.getUbuntuVersionSync();\n    if (parseInt(ubuntuVersion, 10) <= 19) return \"ubuntu18.04\";\n    return \"ubuntu20.04\";\n  }\n  if (platform === \"win32\") return os.arch() === \"x64\" ? \"win64\" : \"win32\";\n  return platform;\n})();\nfunction linuxLddDirectories(browserPath, browser) {\n  if (browser.name === \"chromium\")\n    return [path.join(browserPath, \"chrome-linux\")];\n  if (browser.name === \"firefox\") return [path.join(browserPath, \"firefox\")];\n  if (browser.name === \"webkit\") {\n    return [\n      path.join(browserPath, \"minibrowser-gtk\"),\n      path.join(browserPath, \"minibrowser-gtk\", \"bin\"),\n      path.join(browserPath, \"minibrowser-gtk\", \"lib\"),\n      path.join(browserPath, \"minibrowser-wpe\"),\n      path.join(browserPath, \"minibrowser-wpe\", \"bin\"),\n      path.join(browserPath, \"minibrowser-wpe\", \"lib\"),\n    ];\n  }\n  return [];\n}\nexports.linuxLddDirectories = linuxLddDirectories;\nfunction windowsExeAndDllDirectories(browserPath, browser) {\n  if (browser.name === \"chromium\")\n    return [path.join(browserPath, \"chrome-win\")];\n  if (browser.name === \"firefox\") return [path.join(browserPath, \"firefox\")];\n  if (browser.name === \"webkit\") return [browserPath];\n  return [];\n}\nexports.windowsExeAndDllDirectories = windowsExeAndDllDirectories;\nfunction executablePath(browserPath, browser) {\n  let tokens;\n  if (browser.name === \"chromium\") {\n    tokens = new Map([\n      [\"ubuntu18.04\", [\"chrome-linux\", \"chrome\"]],\n      [\"ubuntu20.04\", [\"chrome-linux\", \"chrome\"]],\n      [\n        \"mac10.13\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\n        \"mac10.14\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\n        \"mac10.15\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\n        \"mac11.0\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\n        \"mac11.0-arm64\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\n        \"mac11.1\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\n        \"mac11.1-arm64\",\n        [\"chrome-mac\", \"Chromium.app\", \"Contents\", \"MacOS\", \"Chromium\"],\n      ],\n      [\"win32\", [\"chrome-win\", \"chrome.exe\"]],\n      [\"win64\", [\"chrome-win\", \"chrome.exe\"]],\n    ]).get(exports.hostPlatform);\n  }\n  if (browser.name === \"firefox\") {\n    tokens = new Map([\n      [\"ubuntu18.04\", [\"firefox\", \"firefox\"]],\n      [\"ubuntu20.04\", [\"firefox\", \"firefox\"]],\n      [\"mac10.13\", [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"]],\n      [\"mac10.14\", [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"]],\n      [\"mac10.15\", [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"]],\n      [\"mac11.0\", [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"]],\n      [\n        \"mac11.0-arm64\",\n        [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"],\n      ],\n      [\"mac11.1\", [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"]],\n      [\n        \"mac11.1-arm64\",\n        [\"firefox\", \"Nightly.app\", \"Contents\", \"MacOS\", \"firefox\"],\n      ],\n      [\"win32\", [\"firefox\", \"firefox.exe\"]],\n      [\"win64\", [\"firefox\", \"firefox.exe\"]],\n    ]).get(exports.hostPlatform);\n  }\n  if (browser.name === \"webkit\") {\n    tokens = new Map([\n      [\"ubuntu18.04\", [\"pw_run.sh\"]],\n      [\"ubuntu20.04\", [\"pw_run.sh\"]],\n      [\"mac10.13\", undefined],\n      [\"mac10.14\", [\"pw_run.sh\"]],\n      [\"mac10.15\", [\"pw_run.sh\"]],\n      [\"mac11.0\", [\"pw_run.sh\"]],\n      [\"mac11.0-arm64\", [\"pw_run.sh\"]],\n      [\"mac11.1\", [\"pw_run.sh\"]],\n      [\"mac11.1-arm64\", [\"pw_run.sh\"]],\n      [\"win32\", [\"Playwright.exe\"]],\n      [\"win64\", [\"Playwright.exe\"]],\n    ]).get(exports.hostPlatform);\n  }\n  return tokens ? path.join(browserPath, ...tokens) : undefined;\n}\nexports.executablePath = executablePath;\nfunction cacheDirectory() {\n  const platform = os.platform();\n  if (platform === \"linux\")\n    return process.env.XDG_CACHE_HOME || path.join(os.homedir(), \".cache\");\n  if (platform === \"darwin\")\n    return path.join(os.homedir(), \"Library\", \"Caches\");\n  if (platform === \"win32\")\n    return (\n      process.env.LOCALAPPDATA || path.join(os.homedir(), \"AppData\", \"Local\")\n    );\n  throw new Error(\"Unsupported platform: \" + platform);\n}\nconst defaultBrowsersPath = (() => {\n  const envDefined = process.env.PLAYWRIGHT_BROWSERS_PATH;\n  // const envDefined = utils_1.getFromENV(\"PLAYWRIGHT_BROWSERS_PATH\");\n  if (envDefined === \"0\") return undefined;\n  return envDefined || path.join(cacheDirectory(), \"ms-playwright\");\n})();\nfunction browsersPath(packagePath) {\n  return defaultBrowsersPath || path.join(packagePath, \".local-browsers\");\n}\nexports.browsersPath = browsersPath;\nfunction browserDirectory(browsersPath, browser) {\n  return path.join(browsersPath, `${browser.name}-${browser.revision}`);\n}\nexports.browserDirectory = browserDirectory;\nfunction markerFilePath(browsersPath, browser) {\n  return path.join(\n    browserDirectory(browsersPath, browser),\n    \"INSTALLATION_COMPLETE\"\n  );\n}\nexports.markerFilePath = markerFilePath;\nfunction isBrowserDirectory(browserPath) {\n  const baseName = path.basename(browserPath);\n  return (\n    baseName.startsWith(\"chromium-\") ||\n    baseName.startsWith(\"firefox-\") ||\n    baseName.startsWith(\"webkit-\")\n  );\n}\nexports.isBrowserDirectory = isBrowserDirectory;\n//# sourceMappingURL=browserPaths.js.map\n","\"use strict\";\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n * Modifications copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getUbuntuVersionSync = exports.getUbuntuVersion = void 0;\nconst fs = require(\"fs\");\nconst os = require(\"os\");\nconst util = require(\"util\");\nconst readFileAsync = util.promisify(fs.readFile.bind(fs));\nasync function getUbuntuVersion() {\n    if (os.platform() !== 'linux')\n        return '';\n    const osReleaseText = await readFileAsync('/etc/os-release', 'utf8').catch(e => '');\n    if (!osReleaseText)\n        return '';\n    return getUbuntuVersionInternal(osReleaseText);\n}\nexports.getUbuntuVersion = getUbuntuVersion;\nfunction getUbuntuVersionSync() {\n    if (os.platform() !== 'linux')\n        return '';\n    try {\n        const osReleaseText = fs.readFileSync('/etc/os-release', 'utf8');\n        if (!osReleaseText)\n            return '';\n        return getUbuntuVersionInternal(osReleaseText);\n    }\n    catch (e) {\n        return '';\n    }\n}\nexports.getUbuntuVersionSync = getUbuntuVersionSync;\nfunction getUbuntuVersionInternal(osReleaseText) {\n    const fields = new Map();\n    for (const line of osReleaseText.split('\\n')) {\n        const tokens = line.split('=');\n        const name = tokens.shift();\n        let value = tokens.join('=').trim();\n        if (value.startsWith('\"') && value.endsWith('\"'))\n            value = value.substring(1, value.length - 1);\n        if (!name)\n            continue;\n        fields.set(name.toLowerCase(), value);\n    }\n    if (!fields.get('name') || fields.get('name').toLowerCase() !== 'ubuntu')\n        return '';\n    return fields.get('version_id') || '';\n}\n//# sourceMappingURL=ubuntuVersion.js.map","\"use strict\";\n/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createGuid = exports.calculateSha1 = exports.monotonicTime = exports.headersArrayToObject = exports.headersObjectToArray = exports.mkdirIfNeeded = exports.getAsBooleanFromENV = exports.getFromENV = exports.isUnderTest = exports.setUnderTest = exports.isDebugMode = exports.isError = exports.isObject = exports.isRegExp = exports.isString = exports.debugAssert = exports.assert = exports.makeWaitForNextTask = void 0;\nconst path = require(\"path\");\nconst fs = require(\"fs\");\nconst util = require(\"util\");\nconst crypto = require(\"crypto\");\nconst mkdirAsync = util.promisify(fs.mkdir.bind(fs));\n// See https://joel.tools/microtasks/\nfunction makeWaitForNextTask() {\n    if (parseInt(process.versions.node, 10) >= 11)\n        return setImmediate;\n    // Unlike Node 11, Node 10 and less have a bug with Task and MicroTask execution order:\n    // - https://github.com/nodejs/node/issues/22257\n    //\n    // So we can't simply run setImmediate to dispatch code in a following task.\n    // However, we can run setImmediate from-inside setImmediate to make sure we're getting\n    // in the following task.\n    let spinning = false;\n    const callbacks = [];\n    const loop = () => {\n        const callback = callbacks.shift();\n        if (!callback) {\n            spinning = false;\n            return;\n        }\n        setImmediate(loop);\n        // Make sure to call callback() as the last thing since it's\n        // untrusted code that might throw.\n        callback();\n    };\n    return (callback) => {\n        callbacks.push(callback);\n        if (!spinning) {\n            spinning = true;\n            setImmediate(loop);\n        }\n    };\n}\nexports.makeWaitForNextTask = makeWaitForNextTask;\nfunction assert(value, message) {\n    if (!value)\n        throw new Error(message);\n}\nexports.assert = assert;\nfunction debugAssert(value, message) {\n    if (isUnderTest() && !value)\n        throw new Error(message);\n}\nexports.debugAssert = debugAssert;\nfunction isString(obj) {\n    return typeof obj === 'string' || obj instanceof String;\n}\nexports.isString = isString;\nfunction isRegExp(obj) {\n    return obj instanceof RegExp || Object.prototype.toString.call(obj) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\nfunction isObject(obj) {\n    return typeof obj === 'object' && obj !== null;\n}\nexports.isObject = isObject;\nfunction isError(obj) {\n    return obj instanceof Error || (obj && obj.__proto__ && obj.__proto__.name === 'Error');\n}\nexports.isError = isError;\nconst isInDebugMode = !!getFromENV('PWDEBUG');\nfunction isDebugMode() {\n    return isInDebugMode;\n}\nexports.isDebugMode = isDebugMode;\nlet _isUnderTest = false;\nfunction setUnderTest() {\n    _isUnderTest = true;\n}\nexports.setUnderTest = setUnderTest;\nfunction isUnderTest() {\n    return _isUnderTest;\n}\nexports.isUnderTest = isUnderTest;\nfunction getFromENV(name) {\n    let value = process.env[name];\n    value = value === undefined ? process.env[`npm_config_${name.toLowerCase()}`] : value;\n    value = value === undefined ? process.env[`npm_package_config_${name.toLowerCase()}`] : value;\n    return value;\n}\nexports.getFromENV = getFromENV;\nfunction getAsBooleanFromENV(name) {\n    const value = getFromENV(name);\n    return !!value && value !== 'false' && value !== '0';\n}\nexports.getAsBooleanFromENV = getAsBooleanFromENV;\nasync function mkdirIfNeeded(filePath) {\n    // This will harmlessly throw on windows if the dirname is the root directory.\n    await mkdirAsync(path.dirname(filePath), { recursive: true }).catch(() => { });\n}\nexports.mkdirIfNeeded = mkdirIfNeeded;\nfunction headersObjectToArray(headers) {\n    const result = [];\n    for (const name in headers) {\n        if (!Object.is(headers[name], undefined))\n            result.push({ name, value: headers[name] });\n    }\n    return result;\n}\nexports.headersObjectToArray = headersObjectToArray;\nfunction headersArrayToObject(headers, lowerCase) {\n    const result = {};\n    for (const { name, value } of headers)\n        result[lowerCase ? name.toLowerCase() : name] = value;\n    return result;\n}\nexports.headersArrayToObject = headersArrayToObject;\nfunction monotonicTime() {\n    const [seconds, nanoseconds] = process.hrtime();\n    return seconds * 1000 + (nanoseconds / 1000 | 0) / 1000;\n}\nexports.monotonicTime = monotonicTime;\nfunction calculateSha1(buffer) {\n    const hash = crypto.createHash('sha1');\n    hash.update(buffer);\n    return hash.digest('hex');\n}\nexports.calculateSha1 = calculateSha1;\nfunction createGuid() {\n    return crypto.randomBytes(16).toString('hex');\n}\nexports.createGuid = createGuid;\n//# sourceMappingURL=utils.js.map","module.exports = require(\"child_process\");;","module.exports = require(\"console-browserify\");;","module.exports = require(\"crypto\");;","module.exports = require(\"events\");;","module.exports = require(\"extract-zip\");;","module.exports = require(\"fs\");;","module.exports = require(\"http\");;","module.exports = require(\"https\");;","module.exports = require(\"https-proxy-agent\");;","module.exports = require(\"os\");;","module.exports = require(\"path\");;","module.exports = require(\"process/browser\");;","module.exports = require(\"progress\");;","module.exports = require(\"proper-lockfile\");;","module.exports = require(\"proxy-from-env\");;","module.exports = require(\"rimraf\");;","module.exports = require(\"url\");;","module.exports = require(\"util\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(391);\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}